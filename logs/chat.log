2025-11-25 17:08:12 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 17:08:42 - INFO - memory_builder - 开始处理对话：输入=啊小具！我改代码改的好崩溃 啊怎么就改不明白了呢，当前主题=None
2025-11-25 17:08:42 - INFO - memory_builder - 无当前活跃记忆，初始化新主题
2025-11-25 17:08:43 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=啊小具！我改代码改的好崩溃 啊怎么就改不
2025-11-25 17:08:45 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=啊小具！我改代码改的好崩溃 啊怎么就改不明白了呢
2025-11-25 17:08:45 - INFO - memory_store - 当前记忆更新：主题=啊小具！我改代码改的好崩溃 啊怎么就改不，更新时间=2025-11-25T17:08:43.943207
2025-11-25 17:08:45 - INFO - memory_builder - 新主题初始化完成：主题=啊小具！我改代码改的好崩溃 啊怎么就改不，关键要素=[]
2025-11-25 17:09:46 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 17:09:46 - INFO - memory_store - 上一个主题记忆已保存到JSONL：主题=啊小具！我改代码改的好崩溃 啊怎么就改不，文件路径=./output/memory_store.jsonl
2025-11-25 17:09:49 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 17:09:59 - INFO - memory_builder - 开始处理对话：输入=小具小具，要吃点下午茶吗，当前主题=None
2025-11-25 17:09:59 - INFO - memory_builder - 无当前活跃记忆，初始化新主题
2025-11-25 17:10:00 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=小具小具，要吃点下午茶吗
2025-11-25 17:10:00 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=小具小具，要吃点下午茶吗
2025-11-25 17:10:00 - INFO - memory_store - 当前记忆更新：主题=小具小具，要吃点下午茶吗，更新时间=2025-11-25T17:10:00.014187
2025-11-25 17:10:00 - INFO - memory_builder - 新主题初始化完成：主题=小具小具，要吃点下午茶吗，关键要素=[]
2025-11-25 17:10:12 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 17:10:12 - INFO - memory_store - 上一个主题记忆已保存到JSONL：主题=小具小具，要吃点下午茶吗，文件路径=./output/memory_store.jsonl
2025-11-25 17:10:50 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 17:10:52 - INFO - memory_builder - 开始处理对话：输入=hello，当前主题=None
2025-11-25 17:10:52 - INFO - memory_builder - 无当前活跃记忆，初始化新主题
2025-11-25 17:10:53 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=hello
2025-11-25 17:10:56 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=hello
2025-11-25 17:10:56 - INFO - memory_store - 当前记忆更新：主题=hello，更新时间=2025-11-25T17:10:53.635744
2025-11-25 17:10:56 - INFO - memory_builder - 新主题初始化完成：主题=hello，关键要素=[]
2025-11-25 17:12:25 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 17:12:25 - INFO - memory_store - 上一个主题记忆已保存到JSONL：主题=hello，文件路径=./output/memory_store.jsonl
2025-11-25 17:12:27 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 17:12:29 - INFO - memory_builder - 开始处理对话：输入=hello，当前主题=None
2025-11-25 17:12:29 - INFO - memory_builder - 无当前活跃记忆，初始化新主题
2025-11-25 17:12:30 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=hello
2025-11-25 17:12:30 - ERROR - main - 记忆构建失败：'LLMClient' object is not callable
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 94, in main
    updated_memory = memory_builder.build_memory(dialog=user_input)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ln123/Document/pythonfile/memory/src/memory_builder.py", line 61, in build_memory
    element = self.element_extractor.extract_elements(dialog=dialog, topic=new_topic.current_topic)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ln123/Document/pythonfile/memory/src/element_extractor.py", line 24, in extract_elements
    raw_result = self.llm_client(prompt=extract_prompt)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'LLMClient' object is not callable
2025-11-25 17:13:01 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 17:13:01 - INFO - memory_store - 无当前活跃记忆，退出时无需保存
2025-11-25 17:18:45 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 17:18:47 - INFO - memory_builder - 开始处理对话：输入=hello，当前主题=None
2025-11-25 17:18:47 - INFO - memory_builder - 无当前活跃记忆，初始化新主题
2025-11-25 17:18:49 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=hello
2025-11-25 17:18:49 - ERROR - main - 记忆构建失败：'LLMClient' object is not callable
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 94, in main
    updated_memory = memory_builder.build_memory(dialog=user_input)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ln123/Document/pythonfile/memory/src/memory_builder.py", line 61, in build_memory
    element = self.element_extractor.extract_elements(dialog=dialog, topic=new_topic.current_topic)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ln123/Document/pythonfile/memory/src/element_extractor.py", line 24, in extract_elements
    raw_result = self.llm_client(prompt=extract_prompt)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'LLMClient' object is not callable
2025-11-25 17:37:32 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 17:37:32 - INFO - memory_store - 无当前活跃记忆，退出时无需保存
2025-11-25 17:56:42 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 17:56:44 - ERROR - main - 程序异常退出：'current_topic'
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 97, in main
    response_prompt = prompt.get_agent_response_prompt(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ln123/Document/pythonfile/memory/src/prompt.py", line 185, in get_agent_response_prompt
    主题：{current_memory['current_topic']}
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
KeyError: 'current_topic'
2025-11-25 20:26:58 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 20:27:01 - INFO - memory_builder - 开始处理完整轮次对话：user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:27:01 - INFO - memory_builder - 无当前活跃记忆，初始化新主题（首轮对话）
2025-11-25 20:27:02 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=user: hello
agent: 你
2025-11-25 20:27:02 - ERROR - main - 轮次记忆构建失败：ElementExtractor.extract_elements() got an unexpected keyword argument 'current_topic'
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 108, in main
    memory_builder.build_memory(
  File "/Users/ln123/Document/pythonfile/memory/src/memory_builder.py", line 75, in build_memory
    element = self.element_extractor.extract_elements(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ElementExtractor.extract_elements() got an unexpected keyword argument 'current_topic'
2025-11-25 20:29:47 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 20:29:47 - INFO - memory_store - 无当前活跃记忆，退出时无需保存
2025-11-25 20:29:49 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 20:29:51 - INFO - memory_builder - 开始处理完整轮次对话：user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:29:51 - INFO - memory_builder - 无当前活跃记忆，初始化新主题（首轮对话）
2025-11-25 20:29:52 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=user: hello
agent: 你
2025-11-25 20:29:52 - ERROR - main - 轮次记忆构建失败：'LLMClient' object is not callable
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 108, in main
    memory_builder.build_memory(
  File "/Users/ln123/Document/pythonfile/memory/src/memory_builder.py", line 75, in build_memory
    element = self.element_extractor.extract_elements(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ln123/Document/pythonfile/memory/src/element_extractor.py", line 24, in extract_elements
    raw_result = self.llm_client(prompt=extract_prompt)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'LLMClient' object is not callable
2025-11-25 20:32:17 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 20:32:17 - INFO - memory_store - 无当前活跃记忆，退出时无需保存
2025-11-25 20:32:19 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 20:32:21 - INFO - memory_builder - 开始处理完整轮次对话：user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:32:21 - INFO - memory_builder - 无当前活跃记忆，初始化新主题（首轮对话）
2025-11-25 20:32:22 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=user: hello
agent: 你
2025-11-25 20:32:24 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:32:24 - INFO - memory_store - 当前记忆更新：主题=user: hello
agent: 你，更新时间=2025-11-25T20:32:22.450118
2025-11-25 20:32:24 - INFO - memory_builder - 首轮主题初始化完成：主题=user: hello
agent: 你，关键要素=[]，对话历史已更新
2025-11-25 20:32:48 - INFO - memory_builder - 开始处理完整轮次对话：user: 晚上要不要去吃宵夜？
agent: 听起来不错啊！有什么好地方推荐吗？
2025-11-25 20:32:48 - ERROR - main - 轮次记忆构建失败：MemoryBuilder._detect_topic_boundary() missing 1 required positional argument: 'new_round_dialog'
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 108, in main
    memory_builder.build_memory(
  File "/Users/ln123/Document/pythonfile/memory/src/memory_builder.py", line 96, in build_memory
    topic_changed = self._detect_topic_boundary(current_round)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: MemoryBuilder._detect_topic_boundary() missing 1 required positional argument: 'new_round_dialog'
2025-11-25 20:35:52 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 20:35:52 - INFO - memory_store - 上一个主题记忆已保存到JSONL：主题=user: hello
agent: 你，文件路径=./output/memory_store.jsonl
2025-11-25 20:35:57 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 20:36:00 - INFO - memory_builder - 开始处理完整轮次对话：user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:36:00 - INFO - memory_builder - 无当前活跃记忆，初始化新主题（首轮对话）
2025-11-25 20:36:00 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=user: hello
agent: 你
2025-11-25 20:36:02 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:36:02 - INFO - memory_store - 当前记忆更新：主题=user: hello
agent: 你，更新时间=2025-11-25T20:36:00.884769
2025-11-25 20:36:02 - INFO - memory_builder - 首轮主题初始化完成：主题=user: hello
agent: 你，关键要素=[]，对话历史已更新
2025-11-25 20:36:21 - INFO - memory_builder - 开始处理完整轮次对话：user: 代码写完喽！
agent: 太棒了！完成代码一定很有成就感吧，接下来有什么打算？
2025-11-25 20:36:22 - WARNING - memory_builder - 话题边界检测结果解析失败，默认判定为未更换：输入=user: hello
agent: 你
2025-11-25 20:36:22 - INFO - memory_builder - 话题未更换，进入要素汇总流程
2025-11-25 20:36:22 - ERROR - main - 轮次记忆构建失败：ElementExtractor.extract_elements() got an unexpected keyword argument 'current_topic'
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 108, in main
    memory_builder.build_memory(
  File "/Users/ln123/Document/pythonfile/memory/src/memory_builder.py", line 158, in build_memory
    element = self.element_extractor.extract_elements(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ElementExtractor.extract_elements() got an unexpected keyword argument 'current_topic'
2025-11-25 20:38:03 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 20:38:03 - INFO - memory_store - 上一个主题记忆已保存到JSONL：主题=user: hello
agent: 你，文件路径=./output/memory_store.jsonl
2025-11-25 20:38:06 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 20:38:11 - INFO - memory_builder - 开始处理完整轮次对话：user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:38:11 - INFO - memory_builder - 无当前活跃记忆，初始化新主题（首轮对话）
2025-11-25 20:38:12 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=user: hello
agent: 你
2025-11-25 20:38:13 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:38:13 - INFO - memory_store - 当前记忆更新：主题=user: hello
agent: 你，更新时间=2025-11-25T20:38:12.901644
2025-11-25 20:38:13 - INFO - memory_builder - 首轮主题初始化完成：主题=user: hello
agent: 你，关键要素=[]，对话历史已更新
2025-11-25 20:38:18 - INFO - memory_builder - 开始处理完整轮次对话：user: 吃完吃饭！
agent: 吃完饭了吗？希望你吃得好！
2025-11-25 20:38:19 - WARNING - memory_builder - 话题边界检测结果解析失败，默认判定为未更换：输入=user: hello
agent: 你
2025-11-25 20:38:19 - INFO - memory_builder - 话题未更换，进入要素汇总流程
2025-11-25 20:38:20 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=user: 吃完吃饭！
agent: 吃完饭了吗？希望你吃得好！
2025-11-25 20:38:20 - INFO - memory_builder - 当前轮要素提取结果：关键要素=[]，细节要素=[]
2025-11-25 20:38:20 - INFO - memory_builder - Info-block汇总完成：关键要素新增0个（总计0个），细节要素新增0个（总计0个）
2025-11-25 20:38:20 - ERROR - main - 轮次记忆构建失败：TopicManager.should_update_topic() got an unexpected keyword argument 'current_key_info'
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 108, in main
    memory_builder.build_memory(
  File "/Users/ln123/Document/pythonfile/memory/src/memory_builder.py", line 187, in build_memory
    if self.topic_manager.should_update_topic(
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TopicManager.should_update_topic() got an unexpected keyword argument 'current_key_info'
2025-11-25 20:39:35 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 20:39:35 - INFO - memory_store - 上一个主题记忆已保存到JSONL：主题=user: hello
agent: 你，文件路径=./output/memory_store.jsonl
2025-11-25 20:39:37 - INFO - main - 程序启动，进入人机交互模式
2025-11-25 20:39:40 - INFO - memory_builder - 开始处理完整轮次对话：user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:39:40 - INFO - memory_builder - 无当前活跃记忆，初始化新主题（首轮对话）
2025-11-25 20:39:43 - WARNING - topic_manager - 主题初始化解析失败，降级使用对话截取：主题=user: hello
agent: 你
2025-11-25 20:39:44 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=user: hello
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:39:44 - INFO - memory_store - 当前记忆更新：主题=user: hello
agent: 你，更新时间=2025-11-25T20:39:43.670730
2025-11-25 20:39:44 - INFO - memory_builder - 首轮主题初始化完成：主题=user: hello
agent: 你，关键要素=[]，对话历史已更新
2025-11-25 20:39:48 - INFO - memory_builder - 开始处理完整轮次对话：user: 你好
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:39:50 - WARNING - memory_builder - 话题边界检测结果解析失败，默认判定为未更换：输入=user: hello
agent: 你
2025-11-25 20:39:50 - INFO - memory_builder - 话题未更换，进入要素汇总流程
2025-11-25 20:39:52 - WARNING - element_extractor - 要素提取解析失败，返回空要素：对话=user: 你好
agent: 你好！有什么可以帮助你的吗？
2025-11-25 20:39:52 - INFO - memory_builder - 当前轮要素提取结果：关键要素=[]，细节要素=[]
2025-11-25 20:39:52 - INFO - memory_builder - Info-block汇总完成：关键要素新增0个（总计0个），细节要素新增0个（总计0个）
2025-11-25 20:39:52 - ERROR - main - 轮次记忆构建失败：'str' object has no attribute 'current_topic'
Traceback (most recent call last):
  File "/Users/ln123/Document/pythonfile/memory/src/main.py", line 108, in main
    memory_builder.build_memory(
  File "/Users/ln123/Document/pythonfile/memory/src/memory_builder.py", line 187, in build_memory
    if self.topic_manager.should_update_topic(
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ln123/Document/pythonfile/memory/src/topic_manager.py", line 63, in should_update_topic
    current_topic=current_topic.current_topic,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'current_topic'
2025-11-25 20:40:21 - INFO - main - 用户强制退出（Ctrl+C）
2025-11-25 20:40:21 - INFO - memory_store - 上一个主题记忆已保存到JSONL：主题=user: hello
agent: 你，文件路径=./output/memory_store.jsonl
